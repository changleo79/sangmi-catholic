# 네이버 클라우드 Object Storage 동기화 가이드

## 현재 구조

### 데이터 저장 위치
- **메타데이터**: `metadata/{type}.json`
  - 예: `metadata/albums.json`, `metadata/bulletins.json`
- **이미지 파일**: `albums/{albumId}/{filename}`
- **썸네일**: `albums/{albumId}/thumbnails/{filename}.webp`

### 동작 방식

1. **어드민에서 추가/삭제**
   - 어드민에서 변경 → `saveDataToServer()` → `api/save-metadata` → 네이버 클라우드에 전체 배열 저장
   - 네이버 클라우드의 JSON 파일이 **완전히 덮어쓰기**됨

2. **페이지 로드**
   - `loadDataFromServer()` → `api/load-metadata` → 네이버 클라우드에서 JSON 파일 읽기
   - 네이버 클라우드에 저장된 최신 데이터를 가져옴

### 네이버 클라우드에서 직접 수정 시

✅ **작동하는 경우:**
- 네이버 클라우드에서 JSON 파일을 직접 수정/삭제
- 다음 페이지 로드 시 변경사항이 반영됨
- `forceRefresh=true`로 로드하면 즉시 반영됨

⚠️ **주의사항:**
- 어드민에서 저장하면 네이버 클라우드에서 직접 추가한 데이터가 덮어쓰기될 수 있음
- 어드민은 항상 전체 배열을 저장하므로, 네이버 클라우드에서 직접 추가한 항목이 어드민에 없으면 삭제됨

### 권장 사용 방법

1. **일반적인 사용**: 어드민 페이지에서만 추가/삭제/수정
2. **네이버 클라우드 직접 수정**: 
   - 백업/복원 목적으로만 사용
   - 직접 수정 후에는 어드민에서 다시 로드하여 확인
   - 어드민에서 저장하기 전에 현재 데이터를 확인

### 데이터 손실 방지

현재 코드는 다음을 보장합니다:
- 서버에서 로드 실패 시 기존 캐시 유지
- 서버 데이터가 없을 때만 빈 배열 반환
- `initializeData`에서 null이 아닌 경우에만 캐시 업데이트

